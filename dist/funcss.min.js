(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){(function(){var ER,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;ER=exports;ER.FunCSSError=function(superClass){extend(FunCSSError,superClass);function FunCSSError(message){this.message=message;this.stack=(new Error).stack}return FunCSSError}(Error);ER.TypeError=function(superClass){extend(TypeError,superClass);function TypeError(){return TypeError.__super__.constructor.apply(this,arguments)}return TypeError}(ER.FunCSSError);ER.SyntaxError=function(superClass){extend(SyntaxError,superClass);function SyntaxError(){return SyntaxError.__super__.constructor.apply(this,arguments)}return SyntaxError}(ER.FunCSSError);ER.UnknownAtRule=function(superClass){extend(UnknownAtRule,superClass);function UnknownAtRule(name){this.name=name;UnknownAtRule.__super__.constructor.call(this,"Unknown at rule: "+this.name)}return UnknownAtRule}(ER.FunCSSError);ER.BlockRequired=function(superClass){extend(BlockRequired,superClass);function BlockRequired(name){this.name=name;BlockRequired.__super__.constructor.call(this,"Block required for "+this.name)}return BlockRequired}(ER.SyntaxError);ER.TypeInferenceNotImplemented=function(superClass){extend(TypeInferenceNotImplemented,superClass);function TypeInferenceNotImplemented(definable){this.definable=definable;TypeInferenceNotImplemented.__super__.constructor.call(this,"Automatic type inference is not yet implemented. Please provide an explicit type for "+this.definable)}return TypeInferenceNotImplemented}(ER.TypeError);ER.UnknownAtRule=function(superClass){extend(UnknownAtRule,superClass);function UnknownAtRule(name){this.name=name;UnknownAtRule.__super__.constructor.call(this,"Unknown at-rule: "+this.name)}return UnknownAtRule}(ER.SyntaxError);ER.UnknownProperty=function(superClass){extend(UnknownProperty,superClass);function UnknownProperty(name){this.name=name;UnknownProperty.__super__.constructor.call(this,"Unknown property: "+this.name)}return UnknownProperty}(ER.TypeError);ER.UnknownType=function(superClass){extend(UnknownType,superClass);function UnknownType(name){this.name=name;UnknownType.__super__.constructor.call(this,"Unknown type: "+this.name)}return UnknownType}(ER.TypeError)}).call(this)},{}],2:[function(require,module,exports){(function(){var IG,camel,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty,slice=[].slice;IG=exports;IG.camel=camel=function(s){if(s.match(/^--/)){return s}return s.toLowerCase().replace(/-([a-z])/g,function(s){return s.charAt(1).toUpperCase()})};IG.JSCode=function(){function JSCode(){}return JSCode}();IG.Statement=function(superClass){extend(Statement,superClass);function Statement(){return Statement.__super__.constructor.apply(this,arguments)}return Statement}(IG.JSCode);IG.Empty=function(superClass){extend(Empty,superClass);function Empty(){return Empty.__super__.constructor.apply(this,arguments)}Empty.prototype.toString=function(){return""};return Empty}(IG.Statement);IG.BlockStatement=function(superClass){extend(BlockStatement,superClass);function BlockStatement(){var value;value=1<=arguments.length?slice.call(arguments,0):[];this.value=value}BlockStatement.prototype.push=function(newStatement){return this.value.push(newStatement)};return BlockStatement}(IG.Statement);IG.Sequence=function(superClass){extend(Sequence,superClass);function Sequence(){return Sequence.__super__.constructor.apply(this,arguments)}Sequence.prototype.toString=function(){return this.value.join("\n")};return Sequence}(IG.BlockStatement);IG.FunctionBlock=function(superClass){extend(FunctionBlock,superClass);function FunctionBlock(){return FunctionBlock.__super__.constructor.apply(this,arguments)}FunctionBlock.prototype.toString=function(){if(this.value.length){return"(function(){\n"+this.value.join("\n")+"\n})();"}else{return""}};return FunctionBlock}(IG.BlockStatement);IG.CssStylesheet=function(superClass){extend(CssStylesheet,superClass);function CssStylesheet(value,name){this.value=value;this.name=name!=null?name:"S"}CssStylesheet.prototype.toString=function(){return"var "+this.name+' = document.createElement("style");\n'+this.name+".innerHTML="+JSON.stringify(""+this.value)+";\ndocument.head.appendChild("+this.name+");"};return CssStylesheet}(IG.Statement);IG.Rule=function(superClass){extend(Rule,superClass);function Rule(cssStylesheet,index){this.cssStylesheet=cssStylesheet;this.index=index}Rule.prototype.toString=function(){return"var rule"+this.index+" = "+this.cssStylesheet.name+".sheet.cssRules["+this.index+"];"};return Rule}(IG.Statement);IG.CustomFunction=function(superClass){extend(CustomFunction,superClass);function CustomFunction(){return CustomFunction.__super__.constructor.apply(this,arguments)}CustomFunction.prototype.toString=function(){return"function "+this.name+"() {\n  "+this.value.join("\n")+"\n  return "+this.returnValue+"\n}"};return CustomFunction}(IG.BlockStatement);IG.ListenerManagerDataSource=function(superClass){extend(ListenerManagerDataSource,superClass);function ListenerManagerDataSource(name,eventType,valueOutsideEventHandler,valueInsideEventHandler){this.name=name;this.eventType=eventType;this.valueOutsideEventHandler=valueOutsideEventHandler;this.valueInsideEventHandler=valueInsideEventHandler}ListenerManagerDataSource.prototype.toString=function(){return"var "+this.name+" = function() {\n    var active = false;\n    var rv = new ReactiveVar;\n    var activeDependentsById = {};\n    var handler = function(event) {\n        for (var id in activeDependentsById) {\n            rv.set("+this.valueInsideEventHandler+');\n            return;\n        }\n        document.removeEventListener("'+this.eventType+'", handler, false);\n        active = false;\n    };\n    return function(){\n        var computation = Tracker.currentComputation;\n        if (computation && !(computation._id in activeDependentsById)) {\n            activeDependentsById[computation._id] = computation;\n            computation.onInvalidate(function() {\n                if (computation.stopped) {\n                    delete activeDependentsById[computation._id];\n                }\n            })\n        }\n        if (!active) {\n            document.addEventListener("'+this.eventType+'", handler, false);\n            active = true;\n            rv.set('+this.valueOutsideEventHandler+");\n        }\n        return rv.get();\n    };\n}();"};return ListenerManagerDataSource}(IG.Statement);IG.Expression=function(superClass){extend(Expression,superClass);function Expression(){return Expression.__super__.constructor.apply(this,arguments)}return Expression}(IG.JSCode);IG.Autorun=function(superClass){extend(Autorun,superClass);function Autorun(){return Autorun.__super__.constructor.apply(this,arguments)}Autorun.prototype.toString=function(){return"Tracker.autorun(function() {\n  "+this.value.join("\n")+"\n});"};return Autorun}(IG.BlockStatement);IG.DomReady=function(superClass){extend(DomReady,superClass);function DomReady(){return DomReady.__super__.constructor.apply(this,arguments)}DomReady.prototype.toString=function(){return'window.addEventListener("load", function() {\n  '+this.value.join("\n")+"\n});"};return DomReady}(IG.BlockStatement);IG.SetDeclarationValue=function(superClass){extend(SetDeclarationValue,superClass);function SetDeclarationValue(ruleIndex,name,value){this.ruleIndex=ruleIndex;this.name=name;this.value=value}SetDeclarationValue.prototype.toString=function(){return"rule"+this.ruleIndex+".style["+JSON.stringify(camel(this.name))+"] = "+this.value.ssjs()+";"};return SetDeclarationValue}(IG.Statement)}).call(this)},{}],3:[function(require,module,exports){(function(){module.exports=function(fs){return fs.ig()}}).call(this)},{}],4:[function(require,module,exports){(function(){exports.present=function(values){var name,value;for(name in values){value=values[name];if(value==null){throw new Error(name+" must be present")}}};exports.hasProp=function(values,property){var name,value;for(name in values){value=values[name];if(value==null){throw new Error(name+" must be present")}if(value[property]==null){throw new Error(name+" must have property "+property)}}};exports.instanceOf=function(values,clazz){var name,value;for(name in values){value=values[name];if(value==null){throw new Error(name+" must be present")}if(!(value instanceof clazz)){throw new Error(name+" must be instance of "+clazz.name)}}};exports.notInstanceOf=function(values,clazz){var name,value;for(name in values){value=values[name];if(value==null){throw new Error(name+" must be present")}if(value instanceof clazz){throw new Error(name+" must not be instance of "+clazz.name)}}};exports.array=function(values,clazz){var name,value;for(name in values){value=values[name];if(value==null){throw new Error(name+" must be present")}if(value.length==null){throw new Error(name+" must be an array")}}};exports["function"]=function(values,clazz){var name,value;for(name in values){value=values[name];if(value==null){throw new Error(name+" must be present")}if(!(value.bind!=null&&value.apply!=null&&value.call!=null)){throw new Error(name+" must be a function")}}}}).call(this)},{}],5:[function(require,module,exports){(function(){var Cascade,FS,GR,IG,SS;SS=require("../../syntax/ss_nodes");GR=require("../../syntax/gr_nodes");FS=require("../fs_nodes");IG=require("../../generator/ig_nodes");module.exports=Cascade=function(){function Cascade(fs){this.fs=fs;this.simpleRules=[]}Cascade.prototype.consume_declaration=function(sel,decl){var type;type=this.fs.getPropertyType(decl.name);type.setFs(this.fs);this.simpleRules.push(new FS.SimpleRule({mediaQuery:null,selector:sel,name:decl.name,value:type.parse(decl.value),important:decl.important}))};Cascade.prototype.puppetRules=function(){var index,pr,sr;return this._puppetRules!=null?this._puppetRules:this._puppetRules=function(){var i,len,ref,results;ref=this.simpleRules;results=[];for(index=i=0,len=ref.length;i<len;index=++i){sr=ref[index];pr=new SS.QualifiedRule(sr.selector);pr.index=index;sr.puppetRule=pr;results.push(pr)}return results}.call(this)};Cascade.prototype.puppetStylesheet=function(){return this._puppetStylesheet!=null?this._puppetStylesheet:this._puppetStylesheet=new SS.Stylesheet(this.puppetRules())};Cascade.prototype.ig=function(){var i,ig,j,len,len1,pss,ref,ref1,sr;ig=new IG.Sequence;ig.push(pss=new IG.CssStylesheet(this.puppetStylesheet()));ref=this.simpleRules;for(i=0,len=ref.length;i<len;i++){sr=ref[i];ig.push(new IG.Rule(pss,sr.puppetRule.index))}ref1=this.simpleRules;for(j=0,len1=ref1.length;j<len1;j++){sr=ref1[j];ig.push(new IG.DomReady(new IG.Autorun(new IG.SetDeclarationValue(sr.puppetRule.index,sr.name,sr.value))))}return ig};return Cascade}()}).call(this)},{"../../generator/ig_nodes":2,"../../syntax/gr_nodes":16,"../../syntax/ss_nodes":19,"../fs_nodes":9}],6:[function(require,module,exports){(function(){var Colon,DF,Definable,DefinableWithOptionalType,Definition,DefinitionInStylesheetLangauge,Dollar,Equals,FunctionalNotation,GR,Parser,SS,Snd,VariableName,VdsGrammar;Parser=require("../../syntax/parser");SS=require("../../syntax/ss_nodes");GR=require("../../syntax/gr_nodes");VdsGrammar=require("../values/vds_grammar");DF=require("./df_nodes");Snd=function(_,y){return y};Colon=new GR.DelimLike(new SS.ColonToken);Equals=new GR.DelimLike(new SS.DelimToken("="));Dollar=new GR.DelimLike(new SS.DelimToken("$"));VariableName=new GR.ExclusiveOr(new GR.Ident(function(x){return new DF.VariableName(x.value)}),new GR.CloselyJuxtaposed(Dollar,new GR.Ident(function(x){return new DF.VariableName("$"+x.value)}),Snd));FunctionalNotation=new GR.AnyFunctionalNotation(VdsGrammar.OptionalRoot,function(name,argument){return new DF.FunctionalNotation(name,argument)});Definable=new GR.ExclusiveOr(VariableName,FunctionalNotation);DefinableWithOptionalType=new GR.Juxtaposition(Definable,new GR.Optional(new GR.Juxtaposition(Colon,new GR.Ident,Snd)),function(variableName,typeName){return[variableName,typeName]});DefinitionInStylesheetLangauge=new GR.Juxtaposition(DefinableWithOptionalType,new GR.Juxtaposition(Equals,new GR.RawTokens,Snd),function(arg,rawValue){var pattern,typeName;pattern=arg[0],typeName=arg[1];return new DF.Definition(pattern,typeName,rawValue)});Definition=DefinitionInStylesheetLangauge;module.exports=Definition}).call(this)},{"../../syntax/gr_nodes":16,"../../syntax/parser":18,"../../syntax/ss_nodes":19,"../values/vds_grammar":14,"./df_nodes":7}],7:[function(require,module,exports){(function(){var DF,FS,GR,SS,Snd,assert,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;SS=require("../../syntax/ss_nodes");GR=require("../../syntax/gr_nodes");assert=require("../../helpers/assert");FS=require("../fs_nodes");DF=exports;Snd=function(_,y){return y};DF.Definable=function(){function Definable(){}return Definable}();DF.VariableName=function(superClass){extend(VariableName,superClass);function VariableName(value1){this.value=value1}VariableName.prototype.grammar=function(semantic){if(this.value.charAt(0)==="$"){return new GR.CloselyJuxtaposed(new GR.DelimLike(new SS.DelimToken("$")),new GR.Keyword(this.value.substr(1)),semantic)}else{return new GR.Keyword(this.value.substr(1),semantic)}};return VariableName}(DF.Definable);DF.FunctionalNotation=function(superClass){extend(FunctionalNotation,superClass);function FunctionalNotation(name,argument){this.name=name;this.argument=argument}FunctionalNotation.prototype.grammar=function(semantic){return new GR.FunctionalNotation(this.name,this.argument,semantic)};return FunctionalNotation}(DF.Definable);DF.Definition=function(){function Definition(definable,type,rawValue){this.definable=definable;this.type=type;this.rawValue=rawValue}Definition.prototype.grammar=function(fs){var gr,value;assert.instanceOf({fs:fs},FS.FunctionalStylesheet);if(this.definable instanceof DF.VariableName){value=fs.getType(this.type).parse(this.rawValue);gr=this.definable.grammar(function(){return value})}else if(this.definable instanceof DF.FunctionalNotation){gr=this.definable.grammar(function(){value=fs.types[this.type].parse(this.rawValue);return value})}else{throw new Error("Internal Error in FunCSS: unknown definable type")}gr.setFs(fs);return gr};return Definition}()}).call(this)},{"../../helpers/assert":4,"../../syntax/gr_nodes":16,"../../syntax/ss_nodes":19,"../fs_nodes":9}],8:[function(require,module,exports){(function(){var DefGrammar,Definitions,GR,IG,Parser,SS,Sel,Semantics,VdsGrammar;Parser=require("../../syntax/parser");SS=require("../../syntax/ss_nodes");GR=require("../../syntax/gr_nodes");Semantics=require("../");Sel=require("../selectors/sel_grammar");VdsGrammar=require("../values/vds_grammar");DefGrammar=require("./def_grammar");IG=require("../../generator/ig_nodes");require("../../syntax/statements");module.exports=Definitions=function(){function Definitions(fs){this.fs=fs;this.definitions}Definitions.prototype.consume_at_rule=function(atrule){var def,i,len,s,statements;if(atrule.value===void 0){throw new ER.BlockRequired("@def")}(new GR.Empty).parse(atrule.prelude,"{");statements=Parser.parse_list_of_statements(atrule.value.value);for(i=0,len=statements.length;i<len;i++){s=statements[i];def=new GR.Optional(DefGrammar).parse(s.value);if(def!=null){this.consume_definition(def)}}};Definitions.prototype.consume_definition=function(def){if(def.type==null){throw new ER.TypeInferenceNotImplemented(def.definable)}this.fs.setType(def.type,def.grammar(this.fs))};Definitions.prototype.ig=function(){return new IG.Empty};return Definitions}()}).call(this)},{"../":10,"../../generator/ig_nodes":2,"../../syntax/gr_nodes":16,"../../syntax/parser":18,"../../syntax/ss_nodes":19,"../../syntax/statements":20,"../selectors/sel_grammar":11,"../values/vds_grammar":14,"./def_grammar":6}],9:[function(require,module,exports){(function(){var Cascade,Definitions,ER,FS,GR,IG,Parser,SS,SelGrammar,Values,VdsGrammar,vds;ER=require("../errors/er_nodes");Parser=require("../syntax/parser");SS=require("../syntax/ss_nodes");GR=require("../syntax/gr_nodes");VdsGrammar=require("./values/vds_grammar");Values=require("./values");IG=require("../generator/ig_nodes");Definitions=require("./definitions");Cascade=require("./cascade");SelGrammar=require("./selectors/sel_grammar");FS=exports;vds=function(str){return VdsGrammar.parse(str)};FS.FunctionalStylesheet=function(){function FunctionalStylesheet(ss){this.definitions=new Definitions(this);this.cascade=new Cascade(this);this.atRuleHandlers={def:this.definitions};this._propertyTypes={"background-color":vds("<ident>"),background:vds("<ident>"),opacity:vds("<number>")};this._typeStack=[Values.primitiveTypes,{}];this._dimensionStack=[Values.dimensions,{}];if(ss!=null){this.consume_stylesheet(ss)}}FunctionalStylesheet.prototype.getPropertyType=function(name,require){var type;if(require==null){require=true}if((type=this._propertyTypes[name])!=null){return type}if(require){throw new ER.UnknownProperty(name)}};FunctionalStylesheet.prototype.setPropertyType=function(name,newType){var oldType;oldType=this.getPropertyType(name,false);return this._propertyTypes[name]=oldType!=null?new GR.ExclusiveOr(oldType,newType):newType};FunctionalStylesheet.prototype.getType=function(name,require){var i,j,ref,type;if(require==null){require=true}for(i=j=ref=this._typeStack.length-1;ref<=0?j<=0:j>=0;i=ref<=0?++j:--j){if((type=this._typeStack[i][name])!=null){return type}}if(require){throw new ER.UnknownType(name)}};FunctionalStylesheet.prototype.setType=function(name,newType){debugger;var oldType;oldType=this.getType(name,false);this._typeStack[this._typeStack.length-1][name]=oldType!=null?new GR.ExclusiveOr(oldType,newType).setFs(this):newType};FunctionalStylesheet.prototype.push_scope=function(){this._typeStack.push({});this._dimensionStack.push({})};FunctionalStylesheet.prototype.pop_scope=function(){this._typeStack.pop({});this._dimensionStack.pop({})};FunctionalStylesheet.prototype.consume_stylesheet=function(ss){var j,len,ref,rule;ref=ss.value;for(j=0,len=ref.length;j<len;j++){rule=ref[j];if(rule instanceof SS.QualifiedRule){this.consume_qualified_rule(rule)}else if(rule instanceof SS.AtRule){this.consume_at_rule(rule)}else{throw new Error("Internal error in FunCSS: Unknown rule type in SS.Stylesheet")}}};FunctionalStylesheet.prototype.consume_at_rule=function(rule){var handler;handler=this.atRuleHandlers[rule.name];if(handler==null){throw new ER.UnknownAtRule(rule.name)}handler.consume_at_rule(rule)};FunctionalStylesheet.prototype.consume_qualified_rule=function(qrule){var decl,j,len,ref,sel;sel=SelGrammar.parse(qrule.prelude);ref=Parser.parse_list_of_declarations(qrule.value.value);for(j=0,len=ref.length;j<len;j++){decl=ref[j];this.cascade.consume_declaration(sel,decl)}};FunctionalStylesheet.prototype.ig=function(){var ig;ig=new IG.FunctionBlock;ig.push(this.definitions.ig());ig.push(this.cascade.ig());return ig};return FunctionalStylesheet}();FS.SimpleRule=function(){function SimpleRule(opts){this.mediaQuery=opts.mediaQuery,this.selector=opts.selector,this.name=opts.name,this.value=opts.value,this.important=opts.important}SimpleRule.prototype.isConstantMediaQuery=function(){return false};SimpleRule.prototype.isConstantValue=function(){return false};SimpleRule.prototype.isConstantSelector=function(){return false};SimpleRule.prototype.selectorSpecificity=function(){return[0,0,0]};return SimpleRule}()}).call(this)},{"../errors/er_nodes":1,"../generator/ig_nodes":2,"../syntax/gr_nodes":16,"../syntax/parser":18,"../syntax/ss_nodes":19,"./cascade":5,"./definitions":8,"./selectors/sel_grammar":11,"./values":13,"./values/vds_grammar":14}],10:[function(require,module,exports){(function(){var FS,SS,Semantics;SS=require("../syntax/ss_nodes");FS=require("./fs_nodes");module.exports=Semantics=function(ss){return new FS.FunctionalStylesheet(ss)}}).call(this)},{"../syntax/ss_nodes":19,"./fs_nodes":9}],11:[function(require,module,exports){(function(){var GR,SL,Selector,SelectorGroup,TypeSelector;GR=require("../../syntax/gr_nodes");SL=require("./sl_nodes");TypeSelector=new GR.Ident(function(x){return new SL.TypeSelector(x.value)});Selector=TypeSelector;SelectorGroup=new GR.DelimitedByComma(Selector);module.exports=SelectorGroup}).call(this)},{"../../syntax/gr_nodes":16,"./sl_nodes":12}],12:[function(require,module,exports){(function(){var SL,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;SL=exports;SL.Selector=function(){function Selector(){}return Selector}();SL.SelectorGroup=function(superClass){extend(SelectorGroup,superClass);function SelectorGroup(value){this.value=value}SelectorGroup.prototype.toString=function(){return this.value.join(", ")};return SelectorGroup}(SL.Selector);SL.CombinedSelector=function(superClass){extend(CombinedSelector,superClass);function CombinedSelector(head1,combinator1,tail1){this.head=head1;this.combinator=combinator1;this.tail=tail1}CombinedSelector.prototype.toString=function(){return""+head+combinator+tail};return CombinedSelector}(SL.Selector);SL.CombinedSelector=function(superClass){extend(CombinedSelector,superClass);function CombinedSelector(){return CombinedSelector.__super__.constructor.apply(this,arguments)}return CombinedSelector}(SL.Selector);SL.Combinator=function(superClass){extend(Combinator,superClass);function Combinator(){return Combinator.__super__.constructor.apply(this,arguments)}return Combinator}(SL.Selector);SL.SimpleSelectorGroup=function(superClass){extend(SimpleSelectorGroup,superClass);function SimpleSelectorGroup(){return SimpleSelectorGroup.__super__.constructor.apply(this,arguments)}return SimpleSelectorGroup}(SL.Selector);SL.SimpleSelector=function(superClass){extend(SimpleSelector,superClass);function SimpleSelector(){return SimpleSelector.__super__.constructor.apply(this,arguments)}return SimpleSelector}(SL.Selector);SL.TypeSelector=function(superClass){extend(TypeSelector,superClass);function TypeSelector(nodeName){this.nodeName=nodeName}TypeSelector.prototype.toString=function(){return""+this.nodeName};return TypeSelector}(SL.SimpleSelector)}).call(this)},{}],13:[function(require,module,exports){(function(){var GR,VL;GR=require("../../syntax/gr_nodes");VL=require("./vl_nodes");exports.primitiveTypes={ident:new GR.Ident(function(x){return new VL.Keyword(x.value)}),number:new GR.Number(function(x){return new VL.Number(x.value)}),integer:new GR.Integer(function(x){return new VL.Number(x.value)}),percentage:new GR.Percentage(function(x){return new VL.Percentage(x.value)}),string:new GR.String(function(x){return new VL.String(x.value)})};exports.dimensions={length:{px:"TODO"}}}).call(this)},{"../../syntax/gr_nodes":16,"./vl_nodes":15}],14:[function(require,module,exports){(function(){var AddMarkings,Ampersand,And,Annotation,Asterisk,Atom,Bar,Bracket,Bracketable,Bracketed,ClosingAngle,ClosingCurly,ClosingSquare,Colon,Column,Combined,Comma,ComponentValue,Cons,DblAmpersand,Dollar,ExclusiveOr,Fst,FunctionalNotation,GR,Hashmark,Id,Ident,InclusiveOr,Integer,Juxtaposition,Keyword,LiteralComma,LiteralSlash,Multipliable,Multiplied,Multiplier,Number,OpeningAngle,OpeningCurly,OpeningSquare,OptionalRoot,PLACEHOLDER,Pair,Percentage,Plus,QuestionMark,RepeatCount,Root,SS,Snd,String,TypeReference,VL,Variable,Vds,isEmptyObject,k,pairsOf,ref,v,slice=[].slice;GR=require("../../syntax/gr_nodes");SS=require("../../syntax/ss_nodes");VL=require("./vl_nodes");Id=Fst=function(x){return x};Snd=function(_,y){return y};Pair=function(x,y){return[x,y]};Cons=function(x,y){y.unshift(x);return y};pairsOf=function(t,list,opts){if(opts==null){opts={}}if(!list.length){throw new Error("internal error in VDS: cannot make pairs of empty list or a non-list")}if(list.length===1){return list[0]}if(list.length===2){return new t(list[0],list[1],opts.pair)}return new t(list[0],pairsOf(t,list.slice(1),opts),opts.cons)};OpeningAngle=new GR.DelimLike(new SS.DelimToken("<"));ClosingAngle=new GR.DelimLike(new SS.DelimToken(">"));OpeningCurly=new GR.DelimLike(new SS.OpeningCurlyToken);ClosingCurly=new GR.DelimLike(new SS.ClosingCurlyToken);OpeningSquare=new GR.DelimLike(new SS.OpeningSquareToken);ClosingSquare=new GR.DelimLike(new SS.ClosingSquareToken);Colon=new GR.DelimLike(new SS.ColonToken);Ampersand=new GR.DelimLike(new SS.DelimToken("&"));DblAmpersand=new GR.CloselyJuxtaposed(Ampersand,Ampersand,function(){});Column=new GR.DelimLike(new SS.ColumnToken);Bar=new GR.DelimLike(new SS.DelimToken("|"));Comma=new GR.DelimLike(new SS.CommaToken);Dollar=new GR.DelimLike(new SS.DelimToken("$"));PLACEHOLDER={parse:function(){throw new Error("PLACEHOLDER not replaced")}};Ident=new GR.Ident;Number=new GR.Number;Integer=new GR.Integer;Percentage=new GR.Percentage;String=new GR.String;AddMarkings=function(x,markings){if(markings&&!isEmptyObject(markings)){return new VL.Marking(x,markings)}else{return x}};LiteralSlash=new GR.DelimLike(new SS.DelimToken("/"),function(x){return new GR.DelimLike(x,function(x){return new VL.Keyword("/")})});LiteralComma=new GR.DelimLike(new SS.CommaToken,function(x){return new GR.DelimLike(x,function(x){return new VL.Keyword(",")})});Hashmark=new GR.DelimLike(new SS.DelimToken("#"),function(){return{collection:VL.CommaDelimitedCollection,multiplier:GR.DelimitedByComma}});Plus=new GR.DelimLike(new SS.DelimToken("+"),function(){return{collection:VL.Collection,multiplier:GR.OneOrMore}});QuestionMark=new GR.DelimLike(new SS.DelimToken("?"),function(){return{collection:false,multiplier:GR.Optional}});Asterisk=new GR.DelimLike(new SS.DelimToken("*"),function(){return{collection:VL.Collection,multiplier:GR.ZeroOrMore}});RepeatCount=new GR.SimpleBlock(SS.OpeningCurlyToken,new GR.CloselyJuxtaposed(Integer,new GR.CloselyJuxtaposed(Comma,Integer,Snd),Pair),function(arg){var from,to;from=arg[0],to=arg[1];return{collection:VL.Collection,multiplier:GR.Range,args:[from,to]}});Keyword=new GR.Ident(function(x){return new GR.Keyword(x.value,function(x){return new VL.Keyword(x.value)})});TypeReference=new GR.Juxtaposition(OpeningAngle,new GR.Juxtaposition(new GR.ExclusiveOr(new GR.Ident(function(x){return[x.value,false]}),new GR.String(function(x){return[x.value,true]})),ClosingAngle,Fst),function(_,arg){var name,quoted;name=arg[0],quoted=arg[1];return new GR.TypeReference(name,quoted)});FunctionalNotation=new GR.AnyFunctionalNotation(PLACEHOLDER,function(name,x){return new GR.FunctionalNotation(name,x,function(y){return new VL.FunctionalNotation(name,y)})});Variable=new GR.ExclusiveOr(new GR.CloselyJuxtaposed(Dollar,Ident,function(x,y){return x+y}),Ident);Variable.expected="variable";Annotation=new GR.Juxtaposition(Variable,new GR.Juxtaposition(Colon,new GR.ExclusiveOr(new GR.Ident(function(x){return new GR.TypeReference(x.value)}),PLACEHOLDER),Snd),function(name,a){return new GR.Annotation(name,a,AddMarkings)});ComponentValue=pairsOf(GR.ExclusiveOr,[TypeReference,Annotation,Keyword,FunctionalNotation,LiteralSlash,LiteralComma]);Bracketable=ComponentValue;Bracket=new GR.SimpleBlock(SS.OpeningSquareToken,PLACEHOLDER);Bracketed=new GR.ExclusiveOr(Bracketable,Bracket);Annotation.b.b.b=Bracket;Multipliable=Bracketed;Multiplier=pairsOf(GR.ExclusiveOr,[Asterisk,Plus,QuestionMark,RepeatCount,Hashmark],{pair:Id,cons:Id});Multiplied=new GR.Juxtaposition(Multipliable,new GR.Optional(Multiplier),function(a,multdata){var ref,ref1;if(multdata){if(multdata.collection){return function(func,args,ctor){ctor.prototype=func.prototype;var child=new ctor,result=func.apply(child,args);return Object(result)===result?result:child}(multdata.multiplier,slice.call((ref=multdata.args)!=null?ref:[]).concat([new GR.AnnotationRoot(a,AddMarkings)],[function(arr){return new multdata.collection(arr)}]),function(){})}else{return function(func,args,ctor){ctor.prototype=func.prototype;var child=new ctor,result=func.apply(child,args);return Object(result)===result?result:child}(multdata.multiplier,slice.call((ref1=multdata.args)!=null?ref1:[]).concat([new GR.AnnotationRoot(a,AddMarkings)],[function(x){return x!=null?x:new VL.EmptyValue}]),function(){})}}else{return a}});isEmptyObject=function(x){var k;for(k in x){if(x.hasOwnProperty(k)){return false}}return true};Juxtaposition=new GR.OneOrMore(Multiplied,function(l){return pairsOf(GR.Juxtaposition,l,{pair:function(x,y){return new VL.Juxtaposition([x,y])},cons:Cons})});And=new GR.DelimitedBy(DblAmpersand,Juxtaposition,function(l){return pairsOf(GR.And,l,{pair:function(x,y){return new VL.And([x,y])},cons:Cons})});InclusiveOr=new GR.DelimitedBy(Column,And,function(l){return pairsOf(GR.InclusiveOr,l,{pair:function(x,y){return new VL.InclusiveOr([x!=null?x:new VL.EmptyValue,y!=null?y:new VL.EmptyValue])},cons:function(x,y){y.unshift(x!=null?x:new VL.EmptyValue);return y}})});ExclusiveOr=new GR.DelimitedBy(Bar,InclusiveOr,function(l){return pairsOf(GR.ExclusiveOr,l,{pair:Id,cons:Id})});Combined=ExclusiveOr;Bracket.a=Combined;FunctionalNotation.a=Combined;Root=new GR.Just(Combined,function(x){return new GR.AnnotationRoot(x,AddMarkings)});OptionalRoot=new GR.Optional(Root,function(x){return x!=null?x:new GR.Empty(function(){return new VL.EmptyValue})});Vds=Root;Atom=Bracketed;module.exports=Vds;ref={Atom:Atom,TypeReference:TypeReference,OptionalRoot:OptionalRoot};for(k in ref){v=ref[k];module.exports[k]=v}}).call(this)},{"../../syntax/gr_nodes":16,"../../syntax/ss_nodes":19,"./vl_nodes":15}],15:[function(require,module,exports){(function(){var VL,escape,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;VL=exports;VL.escape=escape=function(s){return s};VL.Value=VL.Value=function(){function Value(){}return Value}();VL.Constant=function(superClass){extend(Constant,superClass);function Constant(){return Constant.__super__.constructor.apply(this,arguments)}return Constant}(VL.Value);VL.Keyword=function(superClass){extend(Keyword,superClass);function Keyword(value){this.value=value}Keyword.prototype.jsjs=function(){return JSON.stringify(this.value)};Keyword.prototype.ssjs=function(){return JSON.stringify(""+escape(this.value))};return Keyword}(VL.Constant);VL.Percentage=function(superClass){extend(Percentage,superClass);function Percentage(value){this.value=value}Percentage.prototype.jsjs=function(){return JSON.stringify(this.value/100)};Percentage.prototype.ssjs=function(){return JSON.stringify(this.value+"%")};return Percentage}(VL.Constant);VL.Number=function(superClass){extend(Number,superClass);function Number(value){this.value=value}Number.prototype.jsjs=function(){return JSON.stringify(this.value)};Number.prototype.ssjs=function(){return JSON.stringify(""+this.value)};return Number}(VL.Constant);VL.EmptyValue=function(superClass){extend(EmptyValue,superClass);
function EmptyValue(){return EmptyValue.__super__.constructor.apply(this,arguments)}EmptyValue.prototype.jsjs=function(){return"(void 0)"};EmptyValue.prototype.ssjs=function(){return JSON.stringify("")};return EmptyValue}(VL.Constant);VL.String=function(superClass){extend(String,superClass);function String(value){this.value=value}String.prototype.jsjs=function(){return JSON.stringify(this.value)};String.prototype.ssjs=function(){return JSON.stringify(JSON.stringify(this.value))};return String}(VL.Constant);VL.Collection=function(superClass){extend(Collection,superClass);function Collection(value){this.value=value}Collection.prototype.delimiter=" ";Collection.prototype.unshift=function(x){return this.value.unshift(x)};Collection.prototype.jsjs=function(){var i;return"["+function(){var j,len,ref,results;ref=this.value;results=[];for(j=0,len=ref.length;j<len;j++){i=ref[j];results.push(i.jsjs())}return results}.call(this).join(", ")+"]"};Collection.prototype.ssjs=function(){var e,elems,i;elems=function(){var j,len,ref,results;ref=this.value;results=[];for(j=0,len=ref.length;j<len;j++){i=ref[j];results.push(i.ssjs())}return results}.call(this);elems=function(){var j,len,results;results=[];for(j=0,len=elems.length;j<len;j++){e=elems[j];if(e!=='""'){results.push(e)}}return results}();if(elems.length){return elems.join(" + "+JSON.stringify(this.delimiter)+" + ")}else{return JSON.stringify("")}};return Collection}(VL.Value);VL.CommaDelimitedCollection=function(superClass){extend(CommaDelimitedCollection,superClass);function CommaDelimitedCollection(){return CommaDelimitedCollection.__super__.constructor.apply(this,arguments)}CommaDelimitedCollection.prototype.delimiter=", ";return CommaDelimitedCollection}(VL.Collection);VL.Juxtaposition=function(superClass){extend(Juxtaposition,superClass);function Juxtaposition(){return Juxtaposition.__super__.constructor.apply(this,arguments)}return Juxtaposition}(VL.Collection);VL.And=function(superClass){extend(And,superClass);function And(){return And.__super__.constructor.apply(this,arguments)}return And}(VL.Collection);VL.InclusiveOr=function(superClass){extend(InclusiveOr,superClass);function InclusiveOr(){return InclusiveOr.__super__.constructor.apply(this,arguments)}return InclusiveOr}(VL.Collection);VL.Marking=function(superClass){extend(Marking,superClass);function Marking(value,marking){this.value=value;this.marking=marking}Marking.prototype.jsjs=function(){var k,v;return"({"+function(){var ref,results;ref=this.marking;results=[];for(k in ref){v=ref[k];results.push(JSON.stringify(k)+":"+v.jsjs())}return results}.call(this).join(", ")+"})"};Marking.prototype.ssjs=function(){return this.value.ssjs()};return Marking}(VL.Value);VL.FunctionalNotation=function(superClass){extend(FunctionalNotation,superClass);function FunctionalNotation(name,arg){this.name=name;this.arg=arg}FunctionalNotation.prototype.jsjs=function(){return"customFunctions["+JSON.stringify(this.name)+"]("+this.arg.jsjs()+")"};FunctionalNotation.prototype.ssjs=function(){return JSON.stringify(escape(this.name)+"(")+" + "+this.arg.ssjs()+" + "+JSON.stringify(")")};return FunctionalNotation}(VL.Value)}).call(this)},{}],16:[function(require,module,exports){(function(){var Cons,GR,Id,Opt,Or,Parser,SS,Snd,Swap,Tokenizer,Whitespace,assert,max,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;assert=require("../helpers/assert");Tokenizer=require("./tokenizer");Parser=require("./parser");SS=require("./ss_nodes");GR=exports;GR.Stream=function(){function Stream(items,eof1){var t;this.eof=eof1;(this.items=function(){var j,len,results;results=[];for(j=0,len=items.length;j<len;j++){t=items[j];results.push(t)}return results}()).push(new SS.EOFToken(this.eof));this.position=0}Stream.prototype.consume_next=function(){return this.current=this.items[this.position++]};Stream.prototype.next=function(){return this.items[this.position]};Stream.prototype.reconsume_current=function(){return this.items.unshift(this.current)};Stream.prototype.backtrack=function(options){var e,p;try{p=this.position;return options["try"]()}catch(_error){e=_error;if(e instanceof GR.NoMatch){this.position=p;return options.fallback(e)}else{throw e}}};Stream.prototype.optionalWhitespace=function(){while(this.next()instanceof SS.WhitespaceToken){this.consume_next()}};Stream.prototype.noMatchNext=function(expected){throw new GR.NoMatch(expected,this.next(),this,this.position)};Stream.prototype.toStringUntil=function(position){var t;return function(){var j,len,ref,results;ref=this.items.slice(0,position);results=[];for(j=0,len=ref.length;j<len;j++){t=ref[j];results.push(t)}return results}.call(this).join("")};Stream.prototype.toStringFrom=function(position){var t;return function(){var j,len,ref,results;ref=this.items.slice(position);results=[];for(j=0,len=ref.length;j<len;j++){t=ref[j];results.push(t)}return results}.call(this).join("")};return Stream}();GR.NoMatch=function(superClass){extend(NoMatch,superClass);function NoMatch(expected1,found,stream,position1){this.expected=expected1;this.found=found;this.stream=stream;this.position=position1;if(this.found instanceof SS.SimpleBlock){this.found=this.found.token}else if(this.found instanceof SS.Function){this.found=new SS.FunctionToken(this.found.name)}this.name="No match";this.message=typeof message!=="undefined"&&message!==null?message:this.expected+" expected but '"+this.found+"' found";this.stack=this.message+"\n"+this.stackTrace()}NoMatch.prototype.toString=function(){return this.name+": "+this.message};NoMatch.prototype.merge=function(f){if(this.position===f.position){return new GR.NoMatch(this.expected+" or "+f.expected,this.found,this.stream,this.position)}else{throw this.position<f.position?this:f}};NoMatch.prototype.stackTrace=function(){var after,before,i;before=this.stream.toStringUntil(this.position);after=this.stream.toStringFrom(this.position);return""+before+after+"\n"+(function(){var j,ref,results;results=[];for(i=j=1,ref=before.length;1<=ref?j<=ref:j>=ref;i=1<=ref?++j:--j){results.push("-")}return results}().join("")+"^")};return NoMatch}(Error);Id=function(x){return x};Swap=function(f){return function(x,y){return f(y,x)}};Or=function(x,y){return x!=null?x:y};Cons=function(x,y){y.unshift(x);return y};Opt=function(y){return function(x){return x!=null?x:y}};Snd=function(x,y){return y};GR.Type=function(){function Type(semantic){this.semantic=semantic!=null?semantic:this.semantic}Type.prototype.parse=function(input,eof){var result,s;if(eof==null){eof=""}assert.notInstanceOf({input:input},GR.Stream);if(!(input instanceof SS.ComponentValueList)){input=Parser.parse_list_of_component_values(input)}s=new GR.Stream(input,eof);s.optionalWhitespace();result=this.consume(s);s.optionalWhitespace();if(!(s.next()instanceof SS.EOFToken)){s.noMatchNext("'"+eof+"'")}return result};Type.prototype.setFs=function(fs){var ref,ref1;this.fs=fs;if((ref=this.a)!=null){ref.setFs(this.fs)}if((ref1=this.b)!=null){ref1.setFs(this.fs)}return this};return Type}();GR.TokenTypeTokenType=function(superClass){extend(TokenTypeTokenType,superClass);function TokenTypeTokenType(){return TokenTypeTokenType.__super__.constructor.apply(this,arguments)}TokenTypeTokenType.prototype.props={};TokenTypeTokenType.prototype.consume=function(s){var k,next,ref,v;next=s.next();if(next==null){throw new Error("Internal Error in FunCSS: nothing returned from stream")}if(!(next instanceof this.tokenClass)){s.noMatchNext(this.expected)}ref=this.props;for(k in ref){v=ref[k];if(next[k]!==v){s.noMatchNext(this.expected)}}return this.semantic(s.consume_next())};TokenTypeTokenType.prototype.semantic=function(token){};return TokenTypeTokenType}(GR.Type);GR.Keyword=function(superClass){extend(Keyword,superClass);Keyword.prototype.tokenClass=SS.IdentToken;function Keyword(value,semantic){this.value=value;this.semantic=semantic!=null?semantic:this.semantic;this.expected="'"+this.value+"'";this.props={value:this.value}}Keyword.prototype.semantic=function(token){return token.value};return Keyword}(GR.TokenTypeTokenType);GR.Ident=function(superClass){extend(Ident,superClass);function Ident(){return Ident.__super__.constructor.apply(this,arguments)}Ident.prototype.expected="identifier";Ident.prototype.tokenClass=SS.IdentToken;Ident.prototype.semantic=function(token){return token.value};return Ident}(GR.TokenTypeTokenType);GR.Percentage=function(superClass){extend(Percentage,superClass);function Percentage(){return Percentage.__super__.constructor.apply(this,arguments)}Percentage.prototype.expected="percentage";Percentage.prototype.tokenClass=SS.PercentageToken;Percentage.prototype.semantic=function(token){return token.value/100};return Percentage}(GR.TokenTypeTokenType);GR.Number=function(superClass){extend(Number,superClass);function Number(){return Number.__super__.constructor.apply(this,arguments)}Number.prototype.expected="number";Number.prototype.tokenClass=SS.NumberToken;Number.prototype.semantic=function(token){return token.value};return Number}(GR.TokenTypeTokenType);GR.Integer=function(superClass){extend(Integer,superClass);function Integer(){return Integer.__super__.constructor.apply(this,arguments)}Integer.prototype.expected="integer";Integer.prototype.props={type:"integer"};return Integer}(GR.Number);GR.String=function(superClass){extend(String,superClass);function String(){return String.__super__.constructor.apply(this,arguments)}String.prototype.expected="string";String.prototype.tokenClass=SS.StringToken;String.prototype.semantic=function(token){return token.value};return String}(GR.TokenTypeTokenType);Whitespace=function(superClass){extend(Whitespace,superClass);function Whitespace(){return Whitespace.__super__.constructor.apply(this,arguments)}Whitespace.prototype.expected="whitespace";Whitespace.prototype.tokenClass=SS.WhitespaceToken;return Whitespace}(GR.TokenTypeTokenType);GR.DelimLike=function(superClass){extend(DelimLike,superClass);DelimLike.prototype.semantic=function(){return""+this.token};function DelimLike(token1,semantic){this.token=token1;this.semantic=semantic!=null?semantic:this.semantic;this.tokenClass=this.token.constructor;this.expected="'"+this.token+"'";if(this.token instanceof SS.DelimToken){this.tokenClass=SS.DelimToken;this.props={value:this.token.value}}else if(this.token instanceof SS.SimpleToken){return}else{throw new Error("GR.DelimLike expects a DelimToken or a SimpleToken, "+this.token.constructor.name+" got instead")}}return DelimLike}(GR.TokenTypeTokenType);GR.Comma=function(superClass){extend(Comma,superClass);function Comma(){return Comma.__super__.constructor.apply(this,arguments)}Comma.prototype.expected="','";Comma.prototype.tokenClass=SS.CommaToken;return Comma}(GR.TokenTypeTokenType);GR.Optional=function(superClass){extend(Optional,superClass);function Optional(a1,semantic){this.a=a1;this.semantic=semantic!=null?semantic:this.semantic}Optional.prototype.parse=function(input,eof){var result,s;if(eof==null){eof=""}assert.notInstanceOf({input:input},GR.Stream);if(!(input instanceof SS.ComponentValueList)){input=Parser.parse_list_of_component_values(input)}s=new GR.Stream(input,eof);s.optionalWhitespace();if(s.next()instanceof SS.EOFToken){return this.semantic(void 0)}result=this.semantic(this.a.consume(s));s.optionalWhitespace();if(!(s.next()instanceof SS.EOFToken)){s.noMatchNext("'"+eof+"'")}return result};Optional.prototype.consume=function(s){return s.backtrack({"try":function(_this){return function(){return _this.semantic(_this.a.consume(s))}}(this),fallback:function(_this){return function(){return _this.semantic(void 0)}}(this)})};Optional.prototype.semantic=Id;return Optional}(GR.Type);GR.Juxtaposition=function(superClass){extend(Juxtaposition,superClass);function Juxtaposition(a1,b,semantic){this.a=a1;this.b=b;this.semantic=semantic!=null?semantic:this.semantic}Juxtaposition.prototype.consume=function(s){var x,y;x=this.a.consume(s);s.optionalWhitespace();y=this.b.consume(s);return this.semantic(x,y)};return Juxtaposition}(GR.Type);GR.CloselyJuxtaposed=function(superClass){extend(CloselyJuxtaposed,superClass);function CloselyJuxtaposed(a1,b,semantic){this.a=a1;this.b=b;this.semantic=semantic!=null?semantic:this.semantic;assert["function"]({semantic:this.semantic})}CloselyJuxtaposed.prototype.consume=function(s){var x,y;x=this.a.consume(s);y=this.b.consume(s);return this.semantic(x,y)};return CloselyJuxtaposed}(GR.Type);GR.ExclusiveOr=function(superClass){extend(ExclusiveOr,superClass);function ExclusiveOr(a1,b,semantic){this.a=a1;this.b=b;this.semantic=semantic!=null?semantic:this.semantic}ExclusiveOr.prototype.consume=function(s){return s.backtrack({"try":function(_this){return function(){return _this.semantic(_this.a.consume(s))}}(this),fallback:function(_this){return function(e){return s.backtrack({"try":function(){return _this.semantic(_this.b.consume(s))},fallback:function(f){throw e.merge(f)}})}}(this)})};ExclusiveOr.prototype.semantic=Id;return ExclusiveOr}(GR.Type);GR.And=function(superClass){extend(And,superClass);function And(a1,b,semantic){this.a=a1;this.b=b;this.semantic=semantic!=null?semantic:this.semantic}And.prototype.consume=function(s){var res;res=s.backtrack({"try":function(_this){return function(){return{a:_this.a.consume(s)}}}(this),fallback:function(_this){return function(e){return s.backtrack({"try":function(){return{b:_this.b.consume(s)}},fallback:function(f){throw e.merge(f)}})}}(this)});s.optionalWhitespace();if("a"in res){return this.semantic(res.a,this.b.consume(s))}else{return this.semantic(this.a.consume(s),res.b)}};And.prototype.semantic=Cons;return And}(GR.Type);GR.InclusiveOr=function(superClass){extend(InclusiveOr,superClass);function InclusiveOr(a1,b,semantic){this.a=a1;this.b=b;this.semantic=semantic!=null?semantic:this.semantic}InclusiveOr.prototype.consume=function(s){return new GR.ExclusiveOr(new GR.Juxtaposition(this.a,new GR.Optional(this.b),this.semantic),new GR.Juxtaposition(this.b,new GR.Optional(this.a),Swap(this.semantic))).consume(s)};InclusiveOr.prototype.semantic=Cons;return InclusiveOr}(GR.Type);max=function(m,a,s){if(m<=0){return[]}return s.backtrack({"try":function(_this){return function(){var head,tail;head=a.consume(s);s.optionalWhitespace();tail=max(m-1,a,s);tail.unshift(head);return tail}}(this),fallback:function(_this){return function(e){return[]}}(this)})};GR.Range=function(superClass){extend(Range,superClass);Range.prototype.semantic=Id;function Range(n,m1,a1,semantic){this.n=n;this.m=m1;this.a=a1;this.semantic=semantic!=null?semantic:this.semantic}Range.prototype.consume=function(s){var i,j,len,result,tail;result=[];i=0;while(i<this.n){result.push(this.a.consume(s));s.optionalWhitespace();++i}tail=max(this.m-this.n,this.a,s);for(j=0,len=tail.length;j<len;j++){i=tail[j];result.push(i)}return this.semantic(result)};return Range}(GR.Type);GR.ZeroOrMore=function(superClass){extend(ZeroOrMore,superClass);function ZeroOrMore(a1,semantic){this.a=a1;this.semantic=semantic!=null?semantic:this.semantic;this.n=0;this.m=Infinity}return ZeroOrMore}(GR.Range);GR.OneOrMore=function(superClass){extend(OneOrMore,superClass);function OneOrMore(a1,semantic){this.a=a1;this.semantic=semantic!=null?semantic:this.semantic;this.n=1;this.m=Infinity}return OneOrMore}(GR.Range);GR.DelimitedBy=function(superClass){extend(DelimitedBy,superClass);DelimitedBy.prototype.semantic=Id;function DelimitedBy(delim,a1,semantic){this.delim=delim;this.a=a1;this.semantic=semantic!=null?semantic:this.semantic}DelimitedBy.prototype.consume=function(s){return new GR.Juxtaposition(this.a,new GR.ZeroOrMore(new GR.Juxtaposition(this.delim,this.a,Snd)),function(_this){return function(x,y){y.unshift(x);return _this.semantic(y)}}(this)).consume(s)};return DelimitedBy}(GR.Type);GR.DelimitedByComma=function(superClass){extend(DelimitedByComma,superClass);function DelimitedByComma(a1,semantic){this.a=a1;this.semantic=semantic!=null?semantic:this.semantic;this.delim=new GR.Comma}return DelimitedByComma}(GR.DelimitedBy);GR.AnnotationRoot=function(superClass){extend(AnnotationRoot,superClass);AnnotationRoot.prototype.semantic=Id;AnnotationRoot.prototype.hasAnnotations=false;function AnnotationRoot(a1,semantic){this.a=a1;this.semantic=semantic!=null?semantic:this.semantic;this.prepareMappings(this.a)}AnnotationRoot.prototype.prepareMappings=function(node){if(node instanceof GR.AnnotationRoot){if(node instanceof GR.Annotation){this.hasAnnotations=true;node.root=this}return node.prepareMappings(node.a)}else{if(node.a){this.prepareMappings(node.a)}if(node.b){return this.prepareMappings(node.b)}}};AnnotationRoot.prototype.parseWithAnnotations=function(s){var result;this.mappings={};result=this.a.consume(s);return this.semantic(result,this.mappings)};AnnotationRoot.prototype.consume=function(s){if(this.hasAnnotations){return this.parseWithAnnotations(s)}else{return this.semantic(this.a.consume(s))}};return AnnotationRoot}(GR.Type);GR.Annotation=function(superClass){extend(Annotation,superClass);Annotation.prototype.root=void 0;function Annotation(name1,a1,semantic){this.name=name1;this.a=a1;this.semantic=semantic!=null?semantic:this.semantic}Annotation.prototype.consume=function(s){if(this.root){return this.root.mappings[this.name]=this.hasAnnotations?this.parseWithAnnotations(s):this.semantic(this.a.consume(s))}else{throw new Error("GR.Annotation used without an GR.AnnotationRoot correctly configured")}};return Annotation}(GR.AnnotationRoot);GR.SimpleBlock=function(superClass){extend(SimpleBlock,superClass);SimpleBlock.prototype.semantic=function(x){return x};function SimpleBlock(tokenClass,a1,semantic){this.tokenClass=tokenClass;this.a=a1;this.semantic=semantic!=null?semantic:this.semantic;this.expected="'"+new this.tokenClass+"'"}SimpleBlock.prototype.consume=function(s){var next;next=s.next();if(!(next instanceof SS.SimpleBlock)){s.noMatchNext(this.expected)}if(!(next.token instanceof this.tokenClass)){s.noMatchNext(this.expected)}s.consume_next();return this.semantic(this.a.parse(next.value,""+new((new this.tokenClass).mirror())))};return SimpleBlock}(GR.Type);GR.TypeReference=function(superClass){extend(TypeReference,superClass);TypeReference.prototype.semantic=Id;function TypeReference(name1,quoted,semantic){this.name=name1;this.quoted=quoted!=null?quoted:false;this.semantic=semantic!=null?semantic:this.semantic;this.expected=this.name}TypeReference.prototype.consume=function(s){var type;if(!this.fs){throw new Error("Internal error in FunCSS: fs is not set up correctly")}type=this.quoted?this.fs.getPropertyType(this.name):this.fs.getType(this.name);return type.consume(s)};return TypeReference}(GR.Type);GR.FunctionalNotation=function(superClass){extend(FunctionalNotation,superClass);FunctionalNotation.prototype.semantic=Id;function FunctionalNotation(name1,a1,semantic){this.name=name1;this.a=a1;this.semantic=semantic!=null?semantic:this.semantic;this.expected="'"+this.name+"('"}FunctionalNotation.prototype.consume=function(s){var next;next=s.next();if(!(next instanceof SS.Function)){s.noMatchNext(this.expected)}if(next.name!==this.name){s.noMatchNext(this.expected)}s.consume_next();return this.semantic(this.a.parse(next.value,")"))};return FunctionalNotation}(GR.Type);GR.AnyFunctionalNotation=function(superClass){extend(AnyFunctionalNotation,superClass);AnyFunctionalNotation.prototype.expected="function";AnyFunctionalNotation.prototype.semantic=function(name,x){throw Error("No semantic function for GR.AnyFunctionalNotation")};function AnyFunctionalNotation(a1,semantic){this.a=a1;this.semantic=semantic!=null?semantic:this.semantic}AnyFunctionalNotation.prototype.consume=function(s){var next;next=s.next();if(!(next instanceof SS.Function)){s.noMatchNext(this.expected)}s.consume_next();return this.semantic(next.name,this.a.parse(next.value,")"))};return AnyFunctionalNotation}(GR.Type);GR.RawTokens=function(superClass){extend(RawTokens,superClass);RawTokens.prototype.semantic=Id;function RawTokens(semantic){this.semantic=semantic!=null?semantic:this.semantic}RawTokens.prototype.consume=function(s){var next,result;result=new SS.ComponentValueList;next=s.next();while(!(next instanceof SS.EOFToken)){result.push(next);s.consume_next();next=s.next()}return this.semantic(result)};return RawTokens}(GR.Type);GR.Empty=function(superClass){extend(Empty,superClass);function Empty(){return Empty.__super__.constructor.apply(this,arguments)}Empty.prototype.semantic=function(){};Empty.prototype.consume=function(s){return this.semantic()};return Empty}(GR.Type);GR.Just=function(superClass){extend(Just,superClass);Just.prototype.semantic=Id;function Just(a1,semantic){this.a=a1;this.semantic=semantic!=null?semantic:this.semantic}Just.prototype.consume=function(s){return this.semantic(this.a.consume(s))};return Just}(GR.Type)}).call(this)},{"../helpers/assert":4,"./parser":18,"./ss_nodes":19,"./tokenizer":21}],17:[function(require,module,exports){(function(){var Parser;Parser=require(".././syntax/parser");module.exports=function(input){return Parser.parse_stylesheet(input)}}).call(this)},{".././syntax/parser":18}],18:[function(require,module,exports){(function(){var Parser,SS,Tokenizer;Tokenizer=require("./tokenizer");SS=require("./ss_nodes");Parser=function(){function Parser(){}Parser.prototype.init=function(tokens){var t;if(typeof tokens==="string"||tokens instanceof String){this.stream=Tokenizer.tokenize(tokens)}else{this.stream=function(){var i,len,results;results=[];for(i=0,len=tokens.length;i<len;i++){t=tokens[i];results.push(t)}return results}()}return this.current=void 0};Parser.prototype.consume_next=function(){if(this.stream.length){return this.current=this.stream.shift()}else{return this.current=new SS.EOFToken}};Parser.prototype.next=function(){if(this.stream.length){return this.stream[0]}else{return new SS.EOFToken}};Parser.prototype.reconsume_current=function(){return this.stream.unshift(this.current)};Parser.prototype.parse_stylesheet=function(tokens){this.init(tokens);return new SS.Stylesheet(this.consume_list_of_rules(true))};Parser.prototype.parse_list_of_rules=function(tokens){this.init(tokens);return this.consume_list_of_rules(false)};Parser.prototype.parse_rule=function(tokens){var result;this.init(tokens);this.consume_next();while(this.current instanceof SS.WhitespaceToken){this.consume_next()}if(this.current instanceof SS.EOFToken){return new SS.SyntaxError}if(this.current instanceof SS.AtKeywordToken){result=this.consume_at_rule()}else{this.reconsume_current();result=this.consume_qualified_rule();if(result==null){return new SS.SyntaxError}}this.consume_next();while(this.current instanceof SS.WhitespaceToken){this.consume_next()}if(this.current instanceof SS.EOFToken){return result}return new SS.SyntaxError};Parser.prototype.parse_declaration=function(tokens){var result;this.init(tokens);this.consume_next();while(this.current instanceof SS.WhitespaceToken){this.consume_next()}if(!(this.current instanceof SS.IdentToken)){return new SS.SyntaxError}result=this.consume_a_declaration;if(result!=null){return result}else{return new SS.SyntaxError}};Parser.prototype.parse_list_of_declarations=function(tokens){this.init(tokens);return this.consume_list_of_declarations()};Parser.prototype.parse_component_value=function(tokens){var value;this.init(tokens);this.consume_next();while(this.current instanceof SS.WhitespaceToken){this.consume_next()}if(this.current instanceof SS.EOFToken){return new SS.SyntaxError}this.reconsume_current();value=this.consume_component_value();if(value==null){return new SS.SyntaxError}this.consume_next();while(this.current instanceof SS.WhitespaceToken){this.consume_next()}if(this.current instanceof SS.EOFToken){return value}else{return new SS.SyntaxError}};Parser.prototype.parse_list_of_component_values=function(tokens){var result,value;this.init(tokens);result=new SS.ComponentValueList;value=this.consume_component_value();while(!(value instanceof SS.EOFToken)){result.push(value);value=this.consume_component_value()}return result};Parser.prototype.consume_list_of_rules=function(toplevel){var result,rule;result=new SS.RuleList;while(true){this.consume_next();switch(false){case!(this.current instanceof SS.WhitespaceToken):"do nothing";break;case!(this.current instanceof SS.EOFToken):return result;case!(this.current instanceof SS.CDOToken||this.current instanceof SS.CDCToken):if(toplevel){}else{this.reconsume_current();rule=this.consume_qualified_rule();if(rule!=null){result.push(rule)}}break;case!(this.current instanceof SS.AtKeywordToken):rule=this.consume_at_rule();if(rule!=null){result.push(rule)}break;default:this.reconsume_current();rule=this.consume_qualified_rule();if(rule!=null){result.push(rule)}}}};Parser.prototype.consume_at_rule=function(){var block,name,prelude;name=this.current.value;prelude=new SS.ComponentValueList;while(true){this.consume_next();switch(false){case!(this.current instanceof SS.SemicolonToken||this.current instanceof SS.EOFToken):return new SS.AtRule(name,prelude);case!(this.current instanceof SS.OpeningCurlyToken):block=this.consume_simple_block();return new SS.AtRule(name,prelude,block);case!(this.current instanceof SS.SimpleBlock&&this.current.token instanceof SS.OpeningCurlyToken):return new SS.AtRule(name,prelude,this.current);default:this.reconsume_current();prelude.push(this.consume_component_value())}}};Parser.prototype.consume_qualified_rule=function(){var block,prelude;prelude=new SS.ComponentValueList;while(true){this.consume_next();switch(false){case!(this.current instanceof SS.EOFToken):return;case!(this.current instanceof SS.OpeningCurlyToken):block=this.consume_simple_block();return new SS.QualifiedRule(prelude,block);case!(this.current instanceof SS.SimpleBlock&&this.current.token instanceof SS.OpeningCurlyToken):return new SS.QualifiedRule(prelude,this.current);default:this.reconsume_current();prelude.push(this.consume_component_value())}}};Parser.prototype.consume_list_of_declarations=function(){var c,declaration,list,result,temp_stream;result=new SS.DeclarationList;while(true){this.consume_next();switch(false){case!(this.current instanceof SS.WhitespaceToken||this.current instanceof SS.SemicolonToken):"do nothing";break;case!(this.current instanceof SS.EOFToken):return result;case!(this.current instanceof SS.AtKeywordToken):result.push(this.consume_at_rule());break;case!(this.current instanceof SS.IdentToken):list=[this.current];this.consume_next();while(!(this.current instanceof SS.SemicolonToken||this.current instanceof SS.EOFToken)){list.push(this.current);this.consume_next()}temp_stream=this.stream;try{this.stream=list;this.consume_next();declaration=this.consume_a_declaration()}finally{this.stream=temp_stream}if(declaration!=null){result.push(declaration)}break;default:while((c=this.consume_component_value())instanceof SS.SemicolonToken||c instanceof SS.EOFToken){"do nothing"}}}};Parser.prototype.consume_a_declaration=function(){var name,value;name=this.current.value;value=new SS.ComponentValueList;this.consume_next();while(this.current instanceof SS.WhitespaceToken){this.consume_next()}if(!(this.current instanceof SS.ColonToken)){return null}this.consume_next();while(!(this.current instanceof SS.EOFToken)){value.push(this.current);this.consume_next()}return new SS.Declaration(name,value,false)};Parser.prototype.consume_component_value=function(){this.consume_next();if(this.current instanceof SS.OpeningCurlyToken||this.current instanceof SS.OpeningSquareToken||this.current instanceof SS.OpeningParenToken){return this.consume_simple_block()}if(this.current instanceof SS.FunctionToken){return this.consume_function()}return this.current};Parser.prototype.consume_simple_block=function(){var ending,starting,value;starting=this.current;ending=starting.mirror();value=new SS.ComponentValueList;while(true){this.consume_next();switch(false){case!(this.current instanceof SS.EOFToken||this.current instanceof ending):return new SS.SimpleBlock(starting,value);default:this.reconsume_current();value.push(this.consume_component_value())}}};Parser.prototype.consume_function=function(){var name,value;name=this.current.value;value=new SS.ComponentValueList;while(true){this.consume_next();switch(false){case!(this.current instanceof SS.EOFToken||this.current instanceof SS.ClosingParenToken):return new SS.Function(name,value);default:this.reconsume_current();value.push(this.consume_component_value())}}};return Parser}();module.exports=new Parser}).call(this)},{"./ss_nodes":19,"./tokenizer":21}],19:[function(require,module,exports){(function(){var SS,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;SS=exports;SS.Token=function(){function Token(){}return Token}();SS.IdentToken=function(superClass){extend(IdentToken,superClass);function IdentToken(value){this.value=value}IdentToken.prototype.toString=function(){return this.value};return IdentToken}(SS.Token);SS.FunctionToken=function(superClass){extend(FunctionToken,superClass);function FunctionToken(value){this.value=value}FunctionToken.prototype.toString=function(){return this.value+"("};return FunctionToken}(SS.Token);SS.AtKeywordToken=function(superClass){extend(AtKeywordToken,superClass);function AtKeywordToken(value){this.value=value}AtKeywordToken.prototype.toString=function(){return"@"+this.value};return AtKeywordToken}(SS.Token);SS.HashToken=function(superClass){extend(HashToken,superClass);function HashToken(value,type){this.value=value;this.type=type!=null?type:"unrestricted"}HashToken.prototype.toString=function(){return"#"+this.value};return HashToken}(SS.Token);SS.StringToken=function(superClass){extend(StringToken,superClass);function StringToken(value){this.value=value}StringToken.prototype.toString=function(){return JSON.stringify(this.value)};return StringToken}(SS.Token);SS.BadStringToken=function(superClass){extend(BadStringToken,superClass);function BadStringToken(){return BadStringToken.__super__.constructor.apply(this,arguments)}return BadStringToken}(SS.Token);SS.UrlToken=function(){function UrlToken(value){this.value=value}UrlToken.prototype.toString=function(){return"url("+JSON.stringify(this.value)+")"};return UrlToken}();SS.BadUrlToken=function(superClass){extend(BadUrlToken,superClass);function BadUrlToken(){return BadUrlToken.__super__.constructor.apply(this,arguments)}return BadUrlToken}(SS.Token);SS.DelimToken=function(superClass){extend(DelimToken,superClass);function DelimToken(value){this.value=value}DelimToken.prototype.toString=function(){return this.value};return DelimToken}(SS.Token);SS.NumberToken=function(superClass){extend(NumberToken,superClass);function NumberToken(repr,value,type){this.repr=repr;this.value=value;this.type=type!=null?type:"integer"}NumberToken.prototype.toString=function(){return this.repr};return NumberToken}(SS.Token);SS.PercentageToken=function(superClass){extend(PercentageToken,superClass);function PercentageToken(repr,value){this.repr=repr;this.value=value}PercentageToken.prototype.toString=function(){return this.repr+"%"};return PercentageToken}(SS.Token);SS.DimensionToken=function(superClass){extend(DimensionToken,superClass);function DimensionToken(repr,value,type,unit){this.repr=repr;this.value=value;this.type=type!=null?type:"integer";this.unit=unit}DimensionToken.prototype.toString=function(){return this.repr+this.unit};return DimensionToken}(SS.Token);SS.UnicodeRangeToken=function(superClass){extend(UnicodeRangeToken,superClass);function UnicodeRangeToken(start,end){this.start=start;this.end=end}return UnicodeRangeToken}(SS.Token);SS.SimpleToken=function(superClass){extend(SimpleToken,superClass);function SimpleToken(){return SimpleToken.__super__.constructor.apply(this,arguments)
}return SimpleToken}(SS.Token);SS.IncludeMatchToken=function(superClass){extend(IncludeMatchToken,superClass);function IncludeMatchToken(){return IncludeMatchToken.__super__.constructor.apply(this,arguments)}IncludeMatchToken.prototype.toString=function(){return"~="};return IncludeMatchToken}(SS.SimpleToken);SS.DashMatchToken=function(superClass){extend(DashMatchToken,superClass);function DashMatchToken(){return DashMatchToken.__super__.constructor.apply(this,arguments)}DashMatchToken.prototype.toString=function(){return"|="};return DashMatchToken}(SS.SimpleToken);SS.PrefixMatchToken=function(superClass){extend(PrefixMatchToken,superClass);function PrefixMatchToken(){return PrefixMatchToken.__super__.constructor.apply(this,arguments)}PrefixMatchToken.prototype.toString=function(){return"^="};return PrefixMatchToken}(SS.SimpleToken);SS.SuffixMatchToken=function(superClass){extend(SuffixMatchToken,superClass);function SuffixMatchToken(){return SuffixMatchToken.__super__.constructor.apply(this,arguments)}SuffixMatchToken.prototype.toString=function(){return"$="};return SuffixMatchToken}(SS.SimpleToken);SS.SubstringMatchToken=function(superClass){extend(SubstringMatchToken,superClass);function SubstringMatchToken(){return SubstringMatchToken.__super__.constructor.apply(this,arguments)}SubstringMatchToken.prototype.toString=function(){return"*="};return SubstringMatchToken}(SS.SimpleToken);SS.ColumnToken=function(superClass){extend(ColumnToken,superClass);function ColumnToken(){return ColumnToken.__super__.constructor.apply(this,arguments)}ColumnToken.prototype.toString=function(){return"||"};return ColumnToken}(SS.SimpleToken);SS.WhitespaceToken=function(superClass){extend(WhitespaceToken,superClass);function WhitespaceToken(){return WhitespaceToken.__super__.constructor.apply(this,arguments)}WhitespaceToken.prototype.toString=function(){return" "};return WhitespaceToken}(SS.SimpleToken);SS.CDOToken=function(superClass){extend(CDOToken,superClass);function CDOToken(){return CDOToken.__super__.constructor.apply(this,arguments)}CDOToken.prototype.toString=function(){return"<!--"};return CDOToken}(SS.SimpleToken);SS.CDCToken=function(superClass){extend(CDCToken,superClass);function CDCToken(){return CDCToken.__super__.constructor.apply(this,arguments)}CDCToken.prototype.toString=function(){return"-->"};return CDCToken}(SS.SimpleToken);SS.ColonToken=function(superClass){extend(ColonToken,superClass);function ColonToken(){return ColonToken.__super__.constructor.apply(this,arguments)}ColonToken.prototype.toString=function(){return":"};return ColonToken}(SS.SimpleToken);SS.SemicolonToken=function(superClass){extend(SemicolonToken,superClass);function SemicolonToken(){return SemicolonToken.__super__.constructor.apply(this,arguments)}SemicolonToken.prototype.toString=function(){return";"};return SemicolonToken}(SS.SimpleToken);SS.CommaToken=function(superClass){extend(CommaToken,superClass);function CommaToken(){return CommaToken.__super__.constructor.apply(this,arguments)}CommaToken.prototype.toString=function(){return","};return CommaToken}(SS.SimpleToken);SS.OpeningSquareToken=function(superClass){extend(OpeningSquareToken,superClass);function OpeningSquareToken(){return OpeningSquareToken.__super__.constructor.apply(this,arguments)}OpeningSquareToken.prototype.toString=function(){return"["};OpeningSquareToken.prototype.mirror=function(){return SS.ClosingSquareToken};return OpeningSquareToken}(SS.SimpleToken);SS.ClosingSquareToken=function(superClass){extend(ClosingSquareToken,superClass);function ClosingSquareToken(){return ClosingSquareToken.__super__.constructor.apply(this,arguments)}ClosingSquareToken.prototype.toString=function(){return"]"};return ClosingSquareToken}(SS.SimpleToken);SS.OpeningParenToken=function(superClass){extend(OpeningParenToken,superClass);function OpeningParenToken(){return OpeningParenToken.__super__.constructor.apply(this,arguments)}OpeningParenToken.prototype.toString=function(){return"("};OpeningParenToken.prototype.mirror=function(){return SS.ClosingParenToken};return OpeningParenToken}(SS.SimpleToken);SS.ClosingParenToken=function(superClass){extend(ClosingParenToken,superClass);function ClosingParenToken(){return ClosingParenToken.__super__.constructor.apply(this,arguments)}ClosingParenToken.prototype.toString=function(){return")"};return ClosingParenToken}(SS.SimpleToken);SS.OpeningCurlyToken=function(superClass){extend(OpeningCurlyToken,superClass);function OpeningCurlyToken(){return OpeningCurlyToken.__super__.constructor.apply(this,arguments)}OpeningCurlyToken.prototype.toString=function(){return"{"};OpeningCurlyToken.prototype.mirror=function(){return SS.ClosingCurlyToken};return OpeningCurlyToken}(SS.SimpleToken);SS.ClosingCurlyToken=function(superClass){extend(ClosingCurlyToken,superClass);function ClosingCurlyToken(){return ClosingCurlyToken.__super__.constructor.apply(this,arguments)}ClosingCurlyToken.prototype.toString=function(){return"}"};return ClosingCurlyToken}(SS.SimpleToken);SS.EOFToken=function(){function EOFToken(nextToken){this.nextToken=nextToken!=null?nextToken:""}EOFToken.prototype.toString=function(){return this.nextToken};return EOFToken}();SS.AtRule=function(){function AtRule(name3,prelude,value){this.name=name3;this.prelude=prelude;this.value=value!=null?value:void 0}AtRule.prototype.toString=function(){var ref;return"@"+this.name+this.prelude+((ref=this.value)!=null?ref:";")};return AtRule}();SS.QualifiedRule=function(){function QualifiedRule(prelude,value){this.prelude=prelude;this.value=value!=null?value:void 0}QualifiedRule.prototype.toString=function(){var ref,ref1;return this.prelude+" { "+((ref=(ref1=this.value)!=null?ref1.value:void 0)!=null?ref:"")+" }"};return QualifiedRule}();SS.Declaration=function(){function Declaration(name3,value,important){this.name=name3;this.value=value;this.important=important!=null?important:false}return Declaration}();SS.Function=function(){function Function(name3,value){this.name=name3;this.value=value}Function.prototype.toString=function(){return this.name+"("+this.value+")"};return Function}();SS.SimpleBlock=function(){function SimpleBlock(token,value){this.token=token;this.value=value}SimpleBlock.prototype.toString=function(){return""+this.token+this.value+new(this.token.mirror())};return SimpleBlock}();SS.SyntaxError=function(){function SyntaxError(){}return SyntaxError}();SS.RuleList=function(){function RuleList(){}RuleList.prototype=[];return RuleList}();SS.DeclarationList=function(){function DeclarationList(){}DeclarationList.prototype=[];return DeclarationList}();SS.ComponentValueList=function(){function ComponentValueList(){}ComponentValueList.prototype=[];ComponentValueList.commentNeededMap={IdentToken:{IdentToken:true,FunctionToken:true,UrlToken:true,BadUrlToken:true,"-":true,NumberToken:true,PercentageToken:true,DimensionToken:true,UnicodeRangeToken:true,CDCToken:true,"(":true},AtKeywordToken:{IdentToken:true,FunctionToken:true,UrlToken:true,BadUrlToken:true,"-":true,NumberToken:true,PercentageToken:true,DimensionToken:true,UnicodeRangeToken:true,CDCToken:true},HashToken:{IdentToken:true,FunctionToken:true,UrlToken:true,BadUrlToken:true,"-":true,NumberToken:true,PercentageToken:true,DimensionToken:true,UnicodeRangeToken:true,CDCToken:true},DimensionToken:{IdentToken:true,FunctionToken:true,UrlToken:true,BadUrlToken:true,"-":true,NumberToken:true,PercentageToken:true,DimensionToken:true,UnicodeRangeToken:true,CDCToken:true},"#":{IdentToken:true,FunctionToken:true,UrlToken:true,BadUrlToken:true,"-":true,NumberToken:true,PercentageToken:true,DimensionToken:true,UnicodeRangeToken:true},"-":{IdentToken:true,FunctionToken:true,UrlToken:true,BadUrlToken:true,NumberToken:true,PercentageToken:true,DimensionToken:true,UnicodeRangeToken:true},NumberToken:{IdentToken:true,FunctionToken:true,UrlToken:true,BadUrlToken:true,NumberToken:true,PercentageToken:true,DimensionToken:true,UnicodeRangeToken:true},"@":{IdentToken:true,FunctionToken:true,UrlToken:true,BadUrlToken:true,"-":true,UnicodeRangeToken:true},UnicodeRangeToken:{IdentToken:true,FunctionToken:true,NumberToken:true,PercentageToken:true,DimensionToken:true,"?":true},".":{NumberToken:true,PercentageToken:true,DimensionToken:true},"+":{NumberToken:true,PercentageToken:true,DimensionToken:true},$:{"=":true},"*":{"=":true},"^":{"=":true},"~":{"=":true},"|":{"=":true,"|":true},"/":{"*":true}};ComponentValueList.commentNeeded=function(node1,node2){var name,name1,name2,node,ref,ref1;ref=function(){var j,len,results;results=[];for(j=0,len=arguments.length;j<len;j++){node=arguments[j];if(node instanceof SS.SimpleBlock){node=node.token}else if(node instanceof SS.Function){node=new SS.FunctionToken(node.name)}results.push(name=node instanceof SS.DelimToken?node.value:node instanceof SS.OpeningParenToken?"(":node.constructor.name)}return results}.apply(this,arguments),name1=ref[0],name2=ref[1];return!!((ref1=this.commentNeededMap[name1])!=null?ref1[name2]:void 0)};ComponentValueList.prototype.toString=function(){var i,node,result;result=function(){var j,len,results;results=[];for(i=j=0,len=this.length;j<len;i=++j){node=this[i];if(i>0&&i<this.length&&SS.ComponentValueList.commentNeeded(this[i-1],node)){results.push("/**/"+node)}else{results.push(node)}}return results}.call(this);return result.join("")};return ComponentValueList}();SS.Stylesheet=function(){function Stylesheet(value){this.value=value}Stylesheet.prototype.toString=function(){return this.value.join("\n")};return Stylesheet}()}).call(this)},{}],20:[function(require,module,exports){(function(){var Parser,SS,k,ref,v;Parser=require("./parser");SS=require("./ss_nodes");SS.Statement=function(){function Statement(value1){this.value=value1}Statement.prototype.toString=function(){return this.value+";"};return Statement}();SS.StatementList=function(){function StatementList(){}StatementList.prototype=[];StatementList.prototype.toString=function(){return this.join("\n")};return StatementList}();ref={parse_list_of_statements:function(tokens){this.init(tokens);return this.consume_list_of_statements()},consume_list_of_statements:function(){var list,result,statement,temp_stream;result=new SS.StatementList;while(true){this.consume_next();switch(false){case!(this.current instanceof SS.WhitespaceToken||this.current instanceof SS.SemicolonToken):"do nothing";break;case!(this.current instanceof SS.EOFToken):return result;case!(this.current instanceof SS.AtKeywordToken):result.push(this.consume_at_rule());break;default:list=[this.current];this.consume_next();while(!(this.current instanceof SS.SemicolonToken||this.current instanceof SS.EOFToken)){list.push(this.current);this.consume_next()}temp_stream=this.stream;try{this.stream=list;this.consume_next();statement=this.consume_a_statement()}finally{this.stream=temp_stream}if(statement!=null){result.push(statement)}}}},consume_a_statement:function(){var value;value=new SS.ComponentValueList;value.push(this.current);this.consume_next();while(!(this.current instanceof SS.EOFToken)){this.reconsume_current();value.push(this.consume_component_value());this.consume_next()}return new SS.Statement(value,false)}};for(k in ref){v=ref[k];Parser.constructor.prototype[k]=v}}).call(this)},{"./parser":18,"./ss_nodes":19}],21:[function(require,module,exports){(function(){var SS,Tokenizer,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};SS=require("./ss_nodes");Tokenizer=function(){var MAX_ALLOWED_CODE_POINT,MAX_SURROGATE_CODE_POINT,MIN_SURROGATE_CODE_POINT;function Tokenizer(){}Tokenizer.prototype.tokenize=function(string){var token,tokens;this.init(string);tokens=[];while(!((token=this.consume_a_token())instanceof SS.EOFToken)){tokens.push(token)}return tokens};Tokenizer.prototype.init=function(string){this.stream=string.split("");return this.current=void 0};Tokenizer.prototype.consume_next=function(){if(this.stream.length){return this.current=this.stream.shift()}else{return this.current="EOF"}};Tokenizer.prototype.next=function(){if(this.stream.length){return this.stream[0]}else{return"EOF"}};Tokenizer.prototype.next2=function(){if(this.stream.length>1){return this.stream[1]}else{return"EOF"}};Tokenizer.prototype.next3=function(){if(this.stream.length>2){return this.stream[2]}else{return"EOF"}};Tokenizer.prototype.reconsume_current=function(){this.stream.unshift(this.current);return this.current=void 0};Tokenizer.prototype.is_digit=function(c){return"0"<=c&&c<="9"};Tokenizer.prototype.is_hex_digit=function(c){return this.is_digit(c)||"A"<=c&&c<="F"||"a"<=c&&c<="f"};Tokenizer.prototype.is_uppercase_letter=function(c){return"A"<=c&&c<="Z"};Tokenizer.prototype.is_lowercase_letter=function(c){return"a"<=c&&c<="z"};Tokenizer.prototype.is_letter=function(c){return this.is_uppercase_letter(c)||this.is_lowercase_letter(c)};Tokenizer.prototype.is_non_ASCII=function(c){return c.charCodeAt(0)>=128};Tokenizer.prototype.is_name_start_code_point=function(c){return c!=="EOF"&&this.is_letter(c)||this.is_non_ASCII(c)||c==="_"};Tokenizer.prototype.is_name_code_point=function(c){return this.is_name_start_code_point(c)||this.is_digit(c)||c==="-"};Tokenizer.prototype.is_non_printable=function(c){var cc;cc=c.charCodeAt(0);return indexOf.call([0,1,2,3,4,5,6,7,8],cc)>=0||cc===11||indexOf.call([14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],cc)>=0||cc===127};Tokenizer.prototype.is_newline=function(c){return c==="\n"};Tokenizer.prototype.is_whitespace=function(c){return this.is_newline(c)||c==="	"||c===" "};MIN_SURROGATE_CODE_POINT=55296;MAX_SURROGATE_CODE_POINT=57343;Tokenizer.prototype.is_surrogate_code_point=function(c){var i,ref,results;return ref=c.charCodeAt(0),indexOf.call(function(){results=[];for(var i=MIN_SURROGATE_CODE_POINT;MIN_SURROGATE_CODE_POINT<=MAX_SURROGATE_CODE_POINT?i<=MAX_SURROGATE_CODE_POINT:i>=MAX_SURROGATE_CODE_POINT;MIN_SURROGATE_CODE_POINT<=MAX_SURROGATE_CODE_POINT?i++:i--){results.push(i)}return results}.apply(this),ref)>=0};MAX_ALLOWED_CODE_POINT=1114111;Tokenizer.prototype.consume_a_token=function(){var is_id,ref;this.consume_next();switch(false){case!this.is_whitespace(this.current):while(this.is_whitespace(this.next())){this.consume_next()}return new SS.WhitespaceToken;case this.current!=='"':return this.consume_a_string_token('"');case this.current!=="#":if(this.is_name_code_point(this.next())||this.next_2_valid_escape()){is_id=this.next_3_starts_identifier();return new SS.HashToken(this.consume_a_name(),is_id?"id":void 0)}else{return new SS.DelimToken(this.current)}break;case this.current!=="$":if(this.next()==="="){this.consume_next();return new SS.SuffixMatchToken}else{return new SS.DelimToken(this.current)}break;case this.current!=="'":return this.consume_a_string_token("'");case this.current!=="(":return new SS.OpeningParenToken;case this.current!==")":return new SS.ClosingParenToken;case this.current!=="*":if(this.next()==="="){this.consume_next();return new SS.SubstringMatchToken}else{return new SS.DelimToken(this.current)}break;case this.current!=="+":if(this.starts_with_number()){this.reconsume_current();return this.consume_a_numeric_token()}else{return new SS.DelimToken(this.current)}break;case this.current!==",":return new SS.CommaToken;case this.current!=="-":if(this.starts_with_number()){this.reconsume_current();return this.consume_a_numeric_token()}else if(this.next()==="-"&&this.next2()===">"){this.consume_next();this.consume_next();return new SS.CDCToken}else if(this.starts_with_ident()){this.reconsume_current();return this.consume_an_ident_like_token()}else{return new SS.DelimToken(this.current)}break;case this.current!==".":if(this.starts_with_number()){this.reconsume_current();return this.consume_a_numeric_token()}else{return new SS.DelimToken(this.current)}break;case this.current!=="/":if(this.next()==="*"){this.consume_next();while(this.next()!=="EOF"&&!(this.next()==="*"&&this.next2()==="/")){this.consume_next()}if(this.next()==="*"&&this.next2()==="/"){this.consume_next();this.consume_next()}return this.consume_a_token()}else{return new SS.DelimToken(this.current)}break;case this.current!==":":return new SS.ColonToken;case this.current!==";":return new SS.SemicolonToken;case this.current!=="<":if(this.next()==="!"&&this.next2()==="-"&&this.next3()==="-"){this.consume_next();this.consume_next();this.consume_next();return new SS.CDOToken}else{return new SS.DelimToken(this.current)}break;case this.current!=="@":if(this.next_3_starts_identifier()){return new SS.AtKeywordToken(this.consume_a_name())}else{return new SS.DelimToken(this.current)}break;case this.current!=="[":return new SS.OpeningSquareToken;case this.current!=="\\":if(this.starts_with_valid_escape()){this.reconsume_current();return this.consume_an_ident_like_token()}else{return new SS.DelimToken(this.current)}break;case this.current!=="]":return new SS.ClosingSquareToken;case this.current!=="^":if(this.next()==="="){this.consume_next();return new SS.PrefixMatchToken}else{return new SS.DelimToken(this.current)}break;case this.current!=="{":return new SS.OpeningCurlyToken;case this.current!=="}":return new SS.ClosingCurlyToken;case!("0"<=(ref=this.current)&&ref<="9"):this.reconsume_current();return this.consume_a_numeric_token();case!this.is_name_start_code_point(this.current):this.reconsume_current();return this.consume_an_ident_like_token();case this.current!=="|":if(this.next()==="="){this.consume_next();return new SS.DashMatchToken}else if(this.next()==="|"){this.consume_next();return new SS.ColumnToken}else{return new SS.DelimToken(this.current)}break;case this.current!=="~":if(this.next()==="="){this.consume_next();return new SS.IncludeMatchToken}else{return new SS.DelimToken(this.current)}break;case this.current!=="EOF":return new SS.EOFToken;default:return new SS.DelimToken(this.current)}};Tokenizer.prototype.consume_a_numeric_token=function(){var number;number=this.consume_a_number();if(this.next_3_starts_identifier()){return new SS.DimensionToken(number.repr,number.value,number.type,this.consume_a_name())}else if(this.next()==="%"){this.consume_next();return new SS.PercentageToken(number.repr,number.value)}else{return new SS.NumberToken(number.repr,number.value,number.type)}};Tokenizer.prototype.consume_an_ident_like_token=function(){var lowerCase,name;name=this.consume_a_name();lowerCase=name.toLowerCase();if(lowerCase==="url"&&this.next()==="("){this.consume_next();return this.consume_a_url_token()}else if(this.next()==="("){this.consume_next();return new SS.FunctionToken(name)}else{return new SS.IdentToken(name)}};Tokenizer.prototype.consume_a_string_token=function(delim){var s;s=[];while(true){this.consume_next();switch(false){case!(this.current===delim||this.current==="EOF"):return new SS.StringToken(s.join(""));case this.current!=="\n":this.reconsume_current();return new SS.BadStringToken;case this.current!=="\\":if(this.next()==="EOF"){}else if(this.next()==="\n"){this.consume_next()}else{s.push(this.consume_an_escaped_code_point())}break;default:s.push(this.current)}}};Tokenizer.prototype.consume_a_url_token=function(){var ref,ref1,ref2,ref3,ref4,s;s=[];while(this.is_whitespace(this.next())){this.consume_next()}if(this.next()==="EOF"){return new SS.UrlToken(s.join(""))}if((ref=this.next())==="'"||ref==='"'){this.consume_next();SS.stringToken=this.consume_a_string_token(this.current);if(SS.stringToken instanceof SS.BadStringToken){return new SS.BadUrlToken}while(this.is_whitespace(this.next())){this.consume_next()}if((ref1=this.next())===")"||ref1==="EOF"){this.consume_next();return new SS.UrlToken(SS.stringToken.value)}else{this.consume_the_remnants_of_a_bad_url();return new SS.BadUrlToken}}while(true){this.consume_next();switch(false){case(ref2=this.current)!==")"&&ref2!=="EOF":return new SS.UrlToken(s.join(""));case!this.is_whitespace(this.current):while(this.is_whitespace(this.next())){this.consume_next()}if((ref3=this.next())===")"||ref3==="EOF"){this.consume_next();return new SS.UrlToken(s.join(""))}else{this.consume_the_remnants_of_a_bad_url();return new SS.BadUrlToken}break;case!((ref4=this.current)==='"'||ref4==="'"||ref4==="("||this.is_non_printable(this.current)):this.consume_the_remnants_of_a_bad_url();return new SS.BadUrlToken;case this.current!=="\\":if(this.starts_with_valid_escape()){s.push(this.consume_an_escaped_code_point())}else{this.consume_the_remnants_of_a_bad_url();return new SS.UrlToken(s.join(""))}break;default:s.push(this.current)}}};Tokenizer.prototype.consume_a_unicode_range_token=function(){throw"unicode range tokens not implemented yet"};Tokenizer.prototype.consume_an_escaped_code_point=function(){var count,digits,i,number,results;this.consume_next();switch(false){case!this.is_hex_digit(this.current):digits=[this.current];count=1;while(this.is_hex_digit(this.next())&&count<6){digits.push(this.consume_next());++count}if(this.is_whitespace(this.next())){this.consume_next()}number=parseInt(digits.join(""),16);if(number===0||indexOf.call(function(){results=[];for(var i=MIN_SURROGATE_CODE_POINT;MIN_SURROGATE_CODE_POINT<=MAX_SURROGATE_CODE_POINT?i<=MAX_SURROGATE_CODE_POINT:i>=MAX_SURROGATE_CODE_POINT;MIN_SURROGATE_CODE_POINT<=MAX_SURROGATE_CODE_POINT?i++:i--){results.push(i)}return results}.apply(this),number)>=0||number>MAX_ALLOWED_CODE_POINT){return""}break;case this.current!=="EOF":return"";default:return this.current}};Tokenizer.prototype.starts_with_valid_escape=function(){return this.is_valid_escape(this.current,this.next())};Tokenizer.prototype.next_2_valid_escape=function(){return this.is_valid_escape(this.next(),this.next2())};Tokenizer.prototype.is_valid_escape=function(c1,c2){if(c1!=="\\"){return false}if(c2==="\n"){return false}return true};Tokenizer.prototype.starts_with_ident=function(){return this.starts_identifier(this.current,this.next(),this.next2())};Tokenizer.prototype.next_3_starts_identifier=function(){return this.starts_identifier(this.next(),this.next2(),this.next3())};Tokenizer.prototype.starts_identifier=function(c1,c2,c3){switch(false){case c1!=="-":if(this.is_name_start_code_point(c2)||c2==="-"||this.is_valid_escape(c2,c3)){return true}else{return false}break;case!this.is_name_start_code_point(c1):return true;case c1!=="\\":if(this.is_valid_escape(c1,c2)){return true}else{return false}break;default:return false}};Tokenizer.prototype.starts_with_number=function(){return this.starts_number(this.current,this.next(),this.next2())};Tokenizer.prototype.starts_number=function(c1,c2,c3){switch(false){case c1!=="+"&&c1!=="-":if(this.is_digit(c2)){return true}if(c2==="."&&this.is_digit(c3)){return true}return false;case c1!==".":if(this.is_digit(c2)){return true}return false;case!this.is_digit(c1):return true;default:return false}};Tokenizer.prototype.consume_a_name=function(){var s;s=[];while(true){this.consume_next();switch(false){case!this.is_name_code_point(this.current):s.push(this.current);break;case!this.starts_with_valid_escape():s.push(this.consume_an_escaped_code_point());break;default:this.reconsume_current();return s.join("")}}};Tokenizer.prototype.consume_a_number=function(){var ref,ref1,ref2,repr,type,value;repr=[];type="integer";if((ref=this.next())==="+"||ref==="-"){repr.push(this.consume_next())}while(this.is_digit(this.next())){repr.push(this.consume_next())}if(this.next()==="."&&this.is_digit(this.next2())){repr.push(this.consume_next());repr.push(this.consume_next());type="number";while(this.is_digit(this.next())){repr.push(this.consume_next())}}if(((ref1=this.next())==="e"||ref1==="E")&&(this.is_digit(this.next2())||((ref2=this.next2())==="-"||ref2==="+")&&this.is_digit(this.next3()))){repr.push(this.consume_next());if(!this.is_digit(this.next())){repr.push(this.consume_next())}repr.push(this.consume_next());type="number";while(this.is_digit(this.next())){repr.push(this.consume_next())}}repr=repr.join("");value=this.string_to_number(repr);return{repr:repr,value:value,type:type}};Tokenizer.prototype.string_to_number=function(s){return parseFloat(s)};Tokenizer.prototype.consume_the_remnants_of_a_bad_url=function(){while(true){this.consume_next();switch(false){case!(this.current===")"||this.current==="EOF"):return;case!this.starts_with_valid_escape():this.consume_an_escaped_code_point()}}};return Tokenizer}();module.exports=new Tokenizer}).call(this)},{"./ss_nodes":19}],22:[function(require,module,exports){(function(){var Generator,Semantics,Syntax;Syntax=require("./syntax");Semantics=require("./semantics");Generator=require("./generator");exports.compile=function(str){var fs,ig,ss;ss=Syntax(str);fs=Semantics(ss);ig=Generator(fs);return ig.toString()}}).call(this)},{"./generator":3,"./semantics":10,"./syntax":17}]},{},[22]);